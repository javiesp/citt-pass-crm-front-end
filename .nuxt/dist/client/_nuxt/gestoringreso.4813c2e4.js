import{g as F,I as L}from"./IngresoSemanal.d13c7869.js";import{d as M,u as U,r as h,j as $,k as j,a as n,o as u,e as S,b as t,w as e,g as s,l as W,v as z,h as H,c as b,F as q,f as G,t as x}from"./entry.21862ddf.js";import"./userApi.248f1fe6.js";import"./axios.4d564c32.js";import"./projectApi.98219bc6.js";const J=s("div",{class:"d-sm-flex align-center"},[s("div",null,[s("h3",{class:"text-h5 title mb-1"},"Días más concurridos"),s("h5",{class:"text-subtitle-1"},"Análisis semanal")])],-1),K={class:"mt-5"},P={class:"bg-primary pa-5"},Q=s("h2",{class:"text-h5 mb-1"},"Últimos ingresos",-1),X=s("h5",{class:"text-subtitle-1"},"Ingresos diarios",-1),Y={class:"pa-4"},Z={class:"d-flex align-center py-3"},tt=s("div",{class:"mr-3"},null,-1),et={class:"mx-3"},st={class:"text-h6 mt-n1 mb-1"},ot={class:"text-muted"},at={class:"truncate-text text-subtitle-2 textSecondary"},ut=M({__name:"gestoringreso",setup(nt){const T=U(),C=localStorage.getItem("accessToken");console.log("ENCONTRADO !",C),C||(alert("Debes iniciar sesión !!"),T.push("/login")),h([]);const m=h([]),w=h(!1),f=h(!1),D={series:[{name:"Ingresos",data:[]}]};function E(){const o={Mon:0,Tue:0,Wed:0,Thu:0,Fri:0,Sat:0,Sun:0};return m.value.forEach(c=>{const d=new Date(c.entry_date).toLocaleDateString("en-US",{weekday:"short"});o[d]!==void 0&&(o[d]+=1)}),Object.values(o)}const k=async()=>{try{f.value=!0;const o=await F();m.value=o.data,D.series[0].data=E(),f.value=!1}catch(o){console.error(o)}};function A(o,c){const l=document.createElement("a");l.href=URL.createObjectURL(o),l.download=c+".tsv",document.body.appendChild(l),l.click(),document.body.removeChild(l)}function I(){const o=m.value;let c=`FECHA DE ENTRADA	NOMBRE DE USUARIO	MOTIVO	VECES ENTRADA	CITT
`;o.forEach(r=>{let _="",a="",p="";if(r.entry_reason){[_,a]=r.entry_reason.split(":").map(y=>y.trim());const i=r.entry_reason.split("-");i.length>1&&(p=i[1].trim(),a=i[0].trim())}else a="Sin motivo";let g=`${r.entry_date}	${_}	${a}	${r.times_entered}	${p}
`;c+=g});const l=new Blob([c],{type:"text/tab-separated-values"}),d="ingresos_citt_"+Date.now();A(l,d)}const O=$(()=>({grid:{show:!0,borderColor:"transparent",padding:{left:0,right:0,bottom:0}},plotOptions:{bar:{horizontal:!1,columnWidth:"35%",borderRadius:4}},colors:["#1e88e5"],chart:{type:"bar",height:250,toolbar:{show:!1},foreColor:"#adb0bb"},dataLabels:{enabled:!1},xaxis:{categories:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],labels:{style:{cssClass:"grey--text lighten-2--text fill-color"}}},yaxis:{title:{text:"Número de ingresos"},labels:{style:{cssClass:"grey--text lighten-2--text fill-color"}}},tooltip:{theme:"dark"}}));j(()=>{setTimeout(()=>w.value=!0,10)}),k();function N(){}return(o,c)=>{const l=L,d=n("apexchart"),r=n("v-card-text"),_=n("VCard"),a=n("v-col"),p=n("v-btn"),g=n("v-spacer"),i=n("v-row"),y=n("v-progress-circular"),R=n("v-list-item-title"),V=n("v-list-item"),B=n("v-list");return u(),S("div",null,[t(l),t(i,null,{default:e(()=>[s("div",null,[t(i,null,{default:e(()=>[t(a,{cols:"8"},{default:e(()=>[t(_,{class:"pa-3",elevation:"10"},{default:e(()=>[t(r,null,{default:e(()=>[J,W(s("div",K,[t(d,{type:"bar",height:"320",options:O.value,series:D.series},null,8,["options","series"])],512),[[z,w.value]])]),_:1})]),_:1})]),_:1}),t(a,{cols:"4"},{default:e(()=>[t(i,{style:{"margin-bottom":"5px"}},{default:e(()=>[t(a,null,{default:e(()=>[t(p,{onClick:I,variant:"tonal",color:"primary"},{default:e(()=>[H("Descargar ingresos")]),_:1})]),_:1}),t(a,null,{default:e(()=>[t(g)]),_:1})]),_:1}),t(_,{elevation:"10",class:"overflow-hidden",style:{width:"500px"}},{default:e(()=>[t(r,{class:"pa-0"},{default:e(()=>[s("div",P,[t(i,null,{default:e(()=>[t(a)]),_:1}),Q,X]),s("div",Y,[f.value?(u(),b(a,{key:0,cols:"12",class:"text-center"},{default:e(()=>[t(y,{size:200,width:17,color:"primary",indeterminate:""})]),_:1})):(u(),b(a,{key:1},{default:e(()=>[t(B,null,{default:e(()=>[(u(!0),S(q,null,G(m.value.slice(0,8),(v,lt)=>(u(),b(V,{key:v._id,onClick:N},{default:e(()=>[t(R,null,{default:e(()=>[s("div",Z,[tt,s("div",et,[s("h4",st,x(v.entry_reason),1),s("div",ot,"Fecha de entrada: "+x(new Date(v.entry_date).toLocaleDateString()),1),s("div",at," id: "+x(v.uid_user),1)])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}))])]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})])}}});export{ut as default};
