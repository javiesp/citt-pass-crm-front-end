import{_ as w,d as E,a as n,e as c,b as t,w as o,g as h,F as N,r as P,u as T,o as d,h as r,t as D,c as U}from"./entry.09297f61.js";import{g as S,a as $,c as B,d as z,u as O,b as L,e as M}from"./itemApi.4a175f94.js";import{g as q}from"./rackApi.412b9ffa.js";import"./axios.4d564c32.js";const F=E({name:"inventoryItem",data(){return{loading:!1,search:"",itemsPerPage:5,rowsPerPageItems:[{title:"5",value:5},{title:"10",value:10},{title:"25",value:25},{title:"50",value:50}],headers:[{title:"ID",value:"inventory_id"},{title:"Nombre",value:"inventory_name"},{title:"Productos",value:"producto"},{title:"Rack ID",value:"rack_id"},{title:"Acciones",value:"actions"}],headers2:[{title:"Nombre",value:"item_name"},{title:"Precio",value:"item_price"},{title:"Categoría",value:"category"}],solo:null,dialog:!1,dialogRack:!0,dialogItems:!1,selectItem:null,inventoryArray:[],inventoryNames:[],rackIds:[],rackNames:[],rackArray:[],productArray:[],rackId:null,inventoryId:P(null),searchQuery:"",dialogVisible:!1,dialogUpdateVisible:!1,alertVisible:!1,errorAlertVisible:!1,selectedItem:{},objectDto:{inventory_id:null,inventory_name:"",rack_id:null},max:12312312,itemsArray:[]}},computed:{filteredInventory(){return this.searchQuery?this.inventoryArray.filter(e=>e.inventory_name.toLowerCase().includes(this.searchQuery.toLowerCase())):this.inventoryArray}},async created(){const e=localStorage.getItem("accessToken");this.verifyTokenAuth(e);let l=localStorage.getItem("rack_id_cach");!l||l.trim()===""?this.dialogRack=!0:this.dialogRack=!1},methods:{verifyTokenAuth(e){const l=T();e||l.push("/login"),typeof e=="string"&&e.split(".").length!==3&&l.push("/login")},async getInventory(){this.loading=!0;try{const e=await S();this.inventoryArray=e.data,console.log("INVENTARIOS"),console.log(this.inventoryNames)}catch(e){console.error("Error al obtener Inventarios:",e),this.errorAlertVisible=!0}finally{this.loading=!1}},async getWishlist(){try{const e=await $();this.productArray=e.data,console.log("ACA MIRA"),console.log(this.productArray)}catch(e){console.error("Error al obtener PRODUCTOS:",e)}},async getRack(){try{const e=await q();this.rackArray=e.data}catch(e){console.error("Error al obtener Racks:",e)}},downloadPdf(){const e=document.createElement("a");e.href=this.pdfUrl,e.target="_blank",e.download=this.pdfFileName,document.body.appendChild(e),e.click(),document.body.removeChild(e)},getRandomInt(){const e=Math.floor(Math.random()*this.max);return this.objectDto.inventory_id=e,console.log("NUMERO",e),e},async saveInventory(){this.getRandomInt();const e={inventory_id:this.objectDto.inventory_id,inventory_name:this.objectDto.inventory_name,rack_id:this.objectDto.rack_id};console.log(e);try{const l=await B(e);this.getInventory(),console.log("CREATED",l),this.cleanInput(),this.alertVisible=!0,this.dialog=!1}catch(l){console.error("No se ha podido crear el inventario",this.objectDto.inventory_id,l),this.errorAlertVisible=!0}},openDeleteDialog(e){console.log("ITEM",e._id),this.inventoryId=e._id,this.dialogVisible=!0},closeDeleteDialog(){this.dialogVisible=!1},async confirmDeleteInventory(){try{const e=await z(this.inventoryId);this.dialogVisible=!1,this.getInventory(),console.log("DELETED",e),this.alertVisible=!0}catch(e){console.error("No se ha podido eliminar el inventario",this.inventoryId,e),this.errorAlertVisible=!0}},openUpdateDialog(e){this.objectDto={inventory_name:e.inventory_name,rack_id:e.rack_id},this.inventoryId=e._id,this.dialogUpdateVisible=!0},closeUpdateDialog(){this.dialogUpdateVisible=!1,this.cleanInput()},async updateInventory(){console.log("DTO",this.objectDto);const e={inventory_name:this.objectDto.inventory_name,rack_id:this.objectDto.rack_id};try{const l=await O(this.inventoryId,e);this.dialogVisible=!1,this.getInventory(),console.log("UPDATED",l),this.cleanInput(),this.alertVisible=!0,this.dialogUpdateVisible=!1}catch(l){console.error("No se ha podido actualizar el proyecto",this.inventoryId,l),this.errorAlertVisible=!0}},async openProducts(e){const l=e.inventory_id;this.dialogItems=!0;try{const u=await L(l);this.itemsArray=Array.isArray(u.data)?u.data:[u.data],console.log(this.itemsArray)}catch(u){console.log(u),this.itemsArray=[]}},closeItems(){this.itemsArray=[],this.dialogItems=!1},async selectProject(){console.log("SELECTED"),localStorage.setItem("rack_id_cach",this.selectedItem),console.log(this.selectedItem,"<---");try{this.loading=!0;const e=await M(this.selectedItem);console.log(e),this.inventoryArray=e.data,this.loading=!1,this.dialogRack=!1}catch(e){console.error(e)}},openCreateDialog(){this.dialog=!0},closeCreateDialog(){this.dialog=!1},customTitle(){return"Seleccione un rack"},cleanInput(){this.objectDto={inventory_id:null,inventory_name:null,rack_id:null},console.log(this.objectDto)}},mounted(){this.getInventory(),this.getRack()}}),Q=h("h2",null,"Inventarios Citt",-1),W={class:"pa-4 text-center"},G={key:0},H={key:1},J={class:"pa-4 text-center"},K={key:0},X={key:1},Y=h("span",{class:"my-letra"},"Rack",-1),Z={key:0},x={key:1},ee=h("p",{class:"letra-abajo"},"Es necesario que seleccione su grupo para poder gestionar",-1);function te(e,l,u,oe,le,ae){const f=n("v-text-field"),s=n("v-col"),i=n("v-btn"),p=n("v-spacer"),_=n("v-divider"),k=n("v-icon"),A=n("v-data-table"),m=n("v-card"),I=n("v-row"),b=n("v-card-title"),v=n("v-card-text"),y=n("v-card-actions"),g=n("v-dialog"),V=n("v-autocomplete"),C=n("v-alert"),j=n("v-container");return d(),c(N,null,[Q,t(I,{class:"month-table"},{default:o(()=>[t(s,{cols:"3"},{default:o(()=>[t(f,{modelValue:e.search,"onUpdate:modelValue":l[0]||(l[0]=a=>e.search=a),class:"mx-auto",density:"comfortable","menu-icon":"",placeholder:"Buscar inventario","prepend-inner-icon":"mdi-magnify",theme:"light",variant:"solo","auto-select-first":"","item-props":"",hint:"Escriba para buscar",rounded:""},null,8,["modelValue"])]),_:1}),t(s,{cols:"3"},{default:o(()=>[t(i,{variant:"tonal",color:"primary","prepend-icon":"mdi-folder-outline",onClick:e.openCreateDialog},{default:o(()=>[r("Agregar Inventario")]),_:1},8,["onClick"])]),_:1}),t(s,{cols:"3"},{default:o(()=>[t(p),t(i,{variant:"tonal",color:"red","prepend-icon":"mdi-logout",onClick:l[1]||(l[1]=a=>e.dialogRack=!0),text:"cambiar de rack"})]),_:1}),t(s,{cols:"12",sm:"12"},{default:o(()=>[t(m,{variant:e.variant,class:"mx-auto"},{default:o(()=>[t(_),t(s,null,{default:o(()=>[t(A,{"items-per-page":e.itemsPerPage,"onUpdate:itemsPerPage":l[2]||(l[2]=a=>e.itemsPerPage=a),"items-per-page-options":e.rowsPerPageItems,headers:e.headers,items:e.inventoryArray,loading:e.loading,search:e.search},{"item.producto":o(({item:a})=>[t(i,{class:"ml-2",color:"primary",icon:"",size:"x-small",flat:"",onClick:R=>e.openProducts(a)},{default:o(()=>[t(k,null,{default:o(()=>[r("mdi-package-variant-closed")]),_:1})]),_:2},1032,["onClick"])]),"item.actions":o(({item:a})=>[t(i,{class:"ml-2",color:"primary",icon:"",size:"x-small",flat:"",onClick:R=>e.openUpdateDialog(a)},{default:o(()=>[t(k,null,{default:o(()=>[r("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),t(i,{class:"ml-2",color:"error",icon:"",size:"x-small",flat:"",onClick:R=>e.openDeleteDialog(a)},{default:o(()=>[t(k,null,{default:o(()=>[r("mdi-delete")]),_:1})]),_:2},1032,["onClick"])]),_:1},8,["items-per-page","items-per-page-options","headers","items","loading","search"])]),_:1})]),_:1},8,["variant"])]),_:1})]),_:1}),t(g,{modelValue:e.dialogVisible,"onUpdate:modelValue":l[3]||(l[3]=a=>e.dialogVisible=a),"max-width":"400"},{default:o(()=>[t(m,null,{default:o(()=>[t(p),t(b,{class:"text-h5"},{default:o(()=>[r("Confirmar Eliminación")]),_:1}),t(v,null,{default:o(()=>[r("¿Estás seguro de que deseas eliminar este inventario?")]),_:1}),t(y,null,{default:o(()=>[t(p),t(i,{color:"error",text:"",onClick:e.closeDeleteDialog},{default:o(()=>[r("Cancelar")]),_:1},8,["onClick"]),t(i,{color:"primary",text:"",onClick:e.confirmDeleteInventory},{default:o(()=>[r("Eliminar")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),h("div",W,[t(g,{modelValue:e.dialog,"onUpdate:modelValue":l[6]||(l[6]=a=>e.dialog=a),"max-width":"600"},{default:o(()=>[t(m,{"prepend-icon":"mdi-folder-outline",title:"Agregar Inventario"},{default:o(()=>[t(v,null,{default:o(()=>[t(I,{dense:""},{default:o(()=>[t(s,{cols:"12",md:"4",sm:"6"},{default:o(()=>[t(f,{label:"Nombre Inventario",required:"",modelValue:e.objectDto.inventory_name,"onUpdate:modelValue":l[4]||(l[4]=a=>e.objectDto.inventory_name=a)},null,8,["modelValue"])]),_:1}),t(s,null,{default:o(()=>[t(V,{modelValue:e.objectDto.rack_id,"onUpdate:modelValue":l[5]||(l[5]=a=>e.objectDto.rack_id=a),items:e.rackArray,"item-value":"rack_id","item-title":"rack_name",variant:"outlined","display-typed-values":!1},{selection:o(a=>[a.selectedItem?(d(),c("span",G,D(a.selectedItem.rack_name),1)):(d(),c("span",H,"No hay proyecto seleccionado"))]),_:1},8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),t(_),t(y,null,{default:o(()=>[t(p),t(i,{color:"error",text:"Cancelar",variant:"plain",onClick:e.closeCreateDialog},null,8,["onClick"]),t(i,{color:"primary",text:"Guardar Inventario",variant:"tonal",onClick:e.saveInventory},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),h("div",J,[t(g,{modelValue:e.dialogUpdateVisible,"onUpdate:modelValue":l[9]||(l[9]=a=>e.dialogUpdateVisible=a),"max-width":"600"},{default:o(()=>[t(m,{"prepend-icon":"mdi-folder-outline",title:"Actualizar Inventario"},{default:o(()=>[t(v,null,{default:o(()=>[t(I,{dense:""},{default:o(()=>[t(s,{cols:"12",md:"4",sm:"6"},{default:o(()=>[t(f,{label:"Nombre Inventario",required:"",modelValue:e.objectDto.inventory_name,"onUpdate:modelValue":l[7]||(l[7]=a=>e.objectDto.inventory_name=a)},null,8,["modelValue"])]),_:1}),t(s,null,{default:o(()=>[t(V,{modelValue:e.objectDto.rack_id,"onUpdate:modelValue":l[8]||(l[8]=a=>e.objectDto.rack_id=a),items:e.rackArray,"item-value":"rack_id","item-title":"rack_name",variant:"outlined","display-typed-values":!1},{selection:o(a=>[a.selectedItem?(d(),c("span",K,D(a.selectedItem.rack_name),1)):(d(),c("span",X,"No hay proyecto seleccionado"))]),_:1},8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),t(_),t(y,null,{default:o(()=>[t(i,{color:"error",text:"",onClick:e.closeUpdateDialog},{default:o(()=>[r("Cancelar")]),_:1},8,["onClick"]),t(i,{color:"primary",text:"",onClick:e.updateInventory},{default:o(()=>[r("Actualizar")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t(g,{modelValue:e.dialogItems,"onUpdate:modelValue":l[11]||(l[11]=a=>e.dialogItems=a),"max-width":"700px",scrollable:""},{default:o(()=>[t(m,null,{default:o(()=>[t(b,null,{default:o(()=>[r(" Items ")]),_:1}),e.itemsArray&&e.itemsArray.length?(d(),U(v,{key:0},{default:o(()=>[t(A,{headers:e.headers2,items:e.itemsArray},null,8,["headers","items"])]),_:1})):(d(),U(C,{key:1,type:"info"},{default:o(()=>[r(" No hay productos disponibles. ")]),_:1})),t(y,null,{default:o(()=>[t(i,{onClick:l[10]||(l[10]=a=>e.closeItems())},{default:o(()=>[r("Cerrar")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(C,{modelValue:e.errorAlertVisible,"onUpdate:modelValue":l[12]||(l[12]=a=>e.errorAlertVisible=a),dismissible:"",color:"red",elevation:"2","colored-border":"",icon:"mdi-alert",timeout:"5000"},{default:o(()=>[r(" Oops! Ha ocurrido un problema. ")]),_:1},8,["modelValue"]),t(g,{modelValue:e.dialogRack,"onUpdate:modelValue":l[14]||(l[14]=a=>e.dialogRack=a),persistent:"",width:"600"},{default:o(()=>[t(m,null,{default:o(()=>[t(b,null,{default:o(()=>[Y]),_:1}),t(v,null,{default:o(()=>[t(j,null,{default:o(()=>[t(s,{cols:"12"},{default:o(()=>[t(V,{modelValue:e.selectedItem,"onUpdate:modelValue":l[13]||(l[13]=a=>e.selectedItem=a),label:"Selecciona un proyecto...",items:e.rackArray,"item-value":"rack_id","item-title":"rack_name",variant:"underlined","display-typed-values":!1},{selection:o(a=>[a.selectedItem?(d(),c("span",Z,D(a.selectedItem.rack_name),1)):(d(),c("span",x,"No hay proyecto seleccionado"))]),_:1},8,["modelValue","items"]),ee]),_:1})]),_:1})]),_:1}),t(y,null,{default:o(()=>[t(p),t(i,{color:"primary",rounded:!0,elevation:"2",variant:"text",onClick:e.selectProject},{default:o(()=>[r(" Login ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const de=w(F,[["render",te]]);export{de as default};
