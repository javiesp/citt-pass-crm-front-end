import"./userApi.a8dbcbe7.js";import{g as P,s as A,u as w,d as I,c as U}from"./projectApi.98219bc6.js";import{_ as k,d as E,a as r,e as N,b as t,w as o,g as _,F as R,r as B,o as $,h as i}from"./entry.6abbcea1.js";import"./axios.4d564c32.js";const z=E({name:"projectItem",data(){return{loading:!1,search:"",itemsPerPage:5,rowsPerPageItems:[{title:"5",value:5},{title:"10",value:10},{title:"25",value:25},{title:"50",value:50}],headers:[{title:"ID",value:"project_id"},{title:"Nombre",value:"project_name"},{title:"Descripción",value:"project_description"},{title:"Estatus proyecto",value:"project_status"},{title:"ID lista de deseo",value:"wishlist_id"},{title:"Acciones",value:"actions"}],dialogCreate:!1,usersArray:[],projectArray:[],projectsNamesArray:[],statusArray:["En proceso","En pausa","Completo","Sin iniciar","Descartado"],projectId:B(null),totalRows:0,searchQuery:"",selectedProyect:null,pdfUrl:"",pdfFileName:"",dialogVisible:!1,dialogUpdateVisible:!1,alertVisible:!1,errorAlertVisible:!1,objectDto:{project_id:null,project_name:"",project_description:"",project_status:"",wishlist_id:null,project_team_id:null},max:238452345}},computed:{filteredRack(){return this.searchQuery?this.projectArray.filter(e=>e.project_name.toLowerCase().includes(this.searchQuery.toLowerCase())):this.projectArray}},methods:{async getProjects(){this.loading=!0;try{const e=await P();this.projectArray=e.data,this.projectsNamesArray=this.projectArray.map(l=>l.project_name)}catch(e){console.error("Error al obtener proyectos:",e),this.errorAlertVisible=!0}finally{this.loading=!1}},async searchItemByName(){if(console.log("id",this.projectId),this.projectId===null)this.getProjects();else try{const e=await A(this.projectId);this.projectArray=e.data,this.alertVisible=!0}catch(e){console.error("Error al obtener proyectos:",e),this.errorAlertVisible=!0}},downloadPdf(){const e=document.createElement("a");e.href=this.pdfUrl,e.target="_blank",e.download=this.pdfFileName,document.body.appendChild(e),e.click(),document.body.removeChild(e)},openUpdateDialog(e){this.objectDto={project_name:e.project_name,project_description:e.project_description,project_status:e.project_status,wishlist_id:e.wishlist_id,project_team_id:e.project_team_id},this.projectId=e._id,this.dialogUpdateVisible=!0},closeUpdateDialog(){this.clearInput(),this.dialogUpdateVisible=!1},async updateProject(){console.log(this.objectDto);const e={project_name:this.objectDto.project_name,project_description:this.objectDto.project_description,project_status:this.objectDto.project_status,wishlist_id:this.objectDto.wishlist_id,project_team_id:this.objectDto.project_team_id};try{const l=await w(this.projectId,e);this.getProjects(),console.log("UPDATED",l),this.clearInput(),this.dialogVisible=!1,this.alertVisible=!0,this.dialogUpdateVisible=!1}catch(l){console.error("No se ha podido actualizar el proyecto",this.projectId,l),this.errorAlertVisible=!0}},openDeleteDialog(e){this.projectId=e._id,this.dialogVisible=!0,console.log("MIRA ACA"),console.log(this.projectId)},closeDeleteDialog(){this.dialogCreate=!1},async deleteProject(){console.log("aaaaaaaaaaaaaaaaa",this.projectId);try{const e=await I(this.projectId);this.dialogVisible=!1,this.getProjects(),console.log("DELETED",e),this.alertVisible=!0}catch(e){console.error("No se ha podido eliminar el proyecto",this.projectId,e),this.errorAlertVisible=!0}},openCreateDialog(){this.dialogCreate=!0},getRandomInt(){const e=Math.floor(Math.random()*this.max);return this.objectDto.project_id=e,console.log("NUMERO",e),e},async createProject(){this.getRandomInt();const e={project_id:this.objectDto.project_id,project_name:this.objectDto.project_name,project_description:this.objectDto.project_description,project_status:this.objectDto.project_status,wishlist_id:this.objectDto.wishlist_id,project_team_id:this.objectDto.project_team_id};console.log("asd",this.objectDto);try{const l=await U(e);this.getProjects(),console.log("CREATED",l),this.clearInput(),this.dialogCreate=!1,this.alertVisible=!0}catch(l){console.error("No se ha podido eliminar el proyecto",this.objectDto.project_id,l),this.errorAlertVisible=!0}},clearInput(){this.objectDto={project_id:null,project_name:null,project_description:null,project_status:null,wishlist_id:null,project_team_id:null}}},watch:{},async created(){await this.getProjects(),console.log(this.projectArray),console.log("sel",this.projectId)}}),S=_("h2",null,"Proyectos Citt",-1),q={class:"pa-4 text-center"};function F(e,l,M,T,L,Q){const p=r("v-text-field"),s=r("v-col"),n=r("v-btn"),h=r("v-divider"),b=r("v-icon"),V=r("v-data-table"),c=r("v-card"),u=r("v-row"),f=r("v-card-title"),g=r("v-combobox"),v=r("v-textarea"),d=r("v-card-text"),m=r("v-card-actions"),j=r("v-dialog"),y=r("v-spacer"),D=r("v-alert");return $(),N(R,null,[S,t(u,{class:"month-table"},{default:o(()=>[t(s,{cols:"3"},{default:o(()=>[t(p,{modelValue:e.search,"onUpdate:modelValue":l[0]||(l[0]=a=>e.search=a),class:"mx-auto",density:"comfortable","menu-icon":"",placeholder:"Buscar proyecto","prepend-inner-icon":"mdi-magnify",theme:"light",variant:"solo","auto-select-first":"","item-props":"",hint:"Escriba para buscar",rounded:""},null,8,["modelValue"])]),_:1}),t(s,{cols:"3"},{default:o(()=>[t(n,{variant:"tonal",color:"primary","prepend-icon":"mdi-folder-outline",onClick:e.openCreateDialog},{default:o(()=>[i("Agregar Proyecto")]),_:1},8,["onClick"])]),_:1}),t(s,{cols:"12",sm:"12"},{default:o(()=>[t(c,{variant:e.variant,class:"mx-auto"},{default:o(()=>[t(h),t(s,null,{default:o(()=>[t(V,{"items-per-page":e.itemsPerPage,"onUpdate:itemsPerPage":l[1]||(l[1]=a=>e.itemsPerPage=a),"items-per-page-options":e.rowsPerPageItems,headers:e.headers,items:e.projectArray,loading:e.loading,search:e.search},{"item.actions":o(({item:a})=>[t(n,{class:"ml-2",color:"primary",icon:"",size:"x-small",flat:"",onClick:C=>e.openUpdateDialog(a)},{default:o(()=>[t(b,null,{default:o(()=>[i("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),t(n,{class:"ml-2",color:"error",icon:"",size:"x-small",flat:"",onClick:C=>e.openDeleteDialog(a)},{default:o(()=>[t(b,null,{default:o(()=>[i("mdi-delete")]),_:1})]),_:2},1032,["onClick"])]),_:1},8,["items-per-page","items-per-page-options","headers","items","loading","search"])]),_:1})]),_:1},8,["variant"])]),_:1})]),_:1}),t(j,{modelValue:e.dialogUpdateVisible,"onUpdate:modelValue":l[5]||(l[5]=a=>e.dialogUpdateVisible=a),"max-width":"500px"},{default:o(()=>[t(c,null,{default:o(()=>[t(f,null,{default:o(()=>[i(" Actualizar proyecto ")]),_:1}),t(d,null,{default:o(()=>[t(d,null,{default:o(()=>[t(u,null,{default:o(()=>[t(s,{cols:"12",md:"6"},{default:o(()=>[t(p,{label:"Nombre Proyecto",modelValue:e.objectDto.project_name,"onUpdate:modelValue":l[2]||(l[2]=a=>e.objectDto.project_name=a)},null,8,["modelValue"])]),_:1}),t(s,{cols:"12",md:"4"},{default:o(()=>[t(g,{hint:"Status",label:"Status",modelValue:e.objectDto.project_status,"onUpdate:modelValue":l[3]||(l[3]=a=>e.objectDto.project_status=a),items:e.statusArray,variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(s,{cols:"12",md:"10"},{default:o(()=>[t(v,{label:"Descripcion",modelValue:e.objectDto.project_description,"onUpdate:modelValue":l[4]||(l[4]=a=>e.objectDto.project_description=a),variant:"outlined",required:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(m,null,{default:o(()=>[t(n,{color:"error",text:"",onClick:e.closeUpdateDialog},{default:o(()=>[i("Cancelar")]),_:1},8,["onClick"]),t(n,{color:"primary",text:"",onClick:e.updateProject},{default:o(()=>[i("Actualizar")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(j,{modelValue:e.dialogVisible,"onUpdate:modelValue":l[6]||(l[6]=a=>e.dialogVisible=a),"max-width":"500px"},{default:o(()=>[t(c,null,{default:o(()=>[t(f,null,{default:o(()=>[i(" Eliminar proyecto ")]),_:1}),t(d,null,{default:o(()=>[i(" ¿Está seguro de eliminar este proyecto? ")]),_:1}),t(m,null,{default:o(()=>[t(n,{color:"error",text:"",onClick:e.closeDeleteDialog},{default:o(()=>[i("Cancelar")]),_:1},8,["onClick"]),t(n,{color:"primary",text:"",onClick:e.deleteProject},{default:o(()=>[i("Eliminar")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),_("div",q,[t(j,{modelValue:e.dialogCreate,"onUpdate:modelValue":l[10]||(l[10]=a=>e.dialogCreate=a),"max-width":"600"},{default:o(()=>[t(c,{"prepend-icon":"mdi-folder-outline",title:"Agregar Proyecto"},{default:o(()=>[t(d,null,{default:o(()=>[t(u,null,{default:o(()=>[t(s,{cols:"12",md:"4"},{default:o(()=>[t(p,{label:"Nombre Proyecto",modelValue:e.objectDto.project_name,"onUpdate:modelValue":l[7]||(l[7]=a=>e.objectDto.project_name=a),variant:"outlined",required:""},null,8,["modelValue"])]),_:1}),t(s,{cols:"12",md:"4"},{default:o(()=>[t(g,{hint:"Status",label:"Status",modelValue:e.objectDto.project_status,"onUpdate:modelValue":l[8]||(l[8]=a=>e.objectDto.project_status=a),items:e.statusArray,variant:"outlined",required:""},null,8,["modelValue","items"])]),_:1}),t(s,{cols:"12",md:"10"},{default:o(()=>[t(v,{label:"Descripcion",modelValue:e.objectDto.project_description,"onUpdate:modelValue":l[9]||(l[9]=a=>e.objectDto.project_description=a),variant:"outlined",required:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(h),t(m,null,{default:o(()=>[t(y),t(n,{color:"error",text:"Cancelar",variant:"plain",onClick:e.closeDeleteDialog},null,8,["onClick"]),t(n,{color:"primary",text:"Crear proyecto",variant:"tonal",onClick:e.createProject},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_("div",null,[t(D,{modelValue:e.errorAlertVisible,"onUpdate:modelValue":l[11]||(l[11]=a=>e.errorAlertVisible=a),dismissible:"",color:"red",border:"left",elevation:"2","colored-border":"",icon:"mdi-alert",timeout:"5000"},{default:o(()=>[i(" Oops! Ha ocurrido un problema. ")]),_:1},8,["modelValue"])])],64)}const K=k(z,[["render",F]]);export{K as default};
