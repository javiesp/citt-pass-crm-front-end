import{g as D,c as y,d as C,u as U}from"./rackApi.412b9ffa.js";import{_ as j,d as A,a as r,e as I,b as a,w as l,g as f,F as w,o as E,h as i}from"./entry.4c01c827.js";import"./axios.4d564c32.js";const P=A({name:"rackItem",data(){return{loading:!1,search:"",itemsPerPage:5,rowsPerPageItems:[{title:"5",value:5},{title:"10",value:10},{title:"25",value:25},{title:"50",value:50}],headers:[{title:"ID",value:"rack_id"},{title:"Tipo de rack",value:"rack_type"},{title:"Nombre",value:"rack_name"},{title:"Acciones",value:"actions"}],dialog:!1,rackArray:[],rackNames:[],rackId:null,searchQuery:"",totalRows:0,selectedRack:null,dialogVisible:!1,dialogUpdateVisible:!1,alertVisible:!1,errorAlertVisible:!1,objectDto:{rack_id:null,rack_type:"",rack_name:""},loading:!1,max:2934875}},computed:{filteredRack(){return this.searchQuery?this.rackArray.filter(e=>e.rack_name.toLowerCase().includes(this.searchQuery.toLowerCase())):this.rackArray}},methods:{async getRack(){this.loading=!0;try{const e=await D();console.log(e.data),this.rackArray=e.data,this.rackNames=this.rackArray.map(t=>t.rack_name)}catch(e){console.error("Error al obtener Racks:",e),this.errorAlertVisible=!0}finally{this.loading=!1}},downloadPdf(){const e=document.createElement("a");e.href=this.pdfUrl,e.target="_blank",e.download=this.pdfFileName,document.body.appendChild(e),e.click(),document.body.removeChild(e)},openCreateDialog(){this.dialog=!0},closeCreateDialog(){this.dialog=!1},getRandomInt(){const e=Math.floor(Math.random()*this.max);return this.objectDto.rack_id=e,console.log("NUMERO",e),e},async saveRack(){this.getRandomInt(),this.objectDto.rack_id,this.objectDto.rack_type,this.objectDto.rack_name,console.log("Guardar Rack",this.objectDto);try{const e=await y(this.objectDto);this.dialog=!1,this.getRack(),console.log("CREATED",e),this.clearInput(),this.alertVisible=!0,this.objectDto={rack_id:this.rackId,rack_type:"",rack_name:""}}catch(e){console.error("No se ha podido crear el rack",this.objectDto.rack_id,e),this.errorAlertVisible=!0}},openDeleteDialog(e){this.rackId=e._id,console.log("ITEM",this.rackId),this.dialogVisible=!0},closeDeleteDialog(){this.dialogVisible=!1},async confirmDeleteRack(){try{const e=await C(this.rackId);this.dialogVisible=!1,this.getRack(),console.log("DELETED",e),this.alertVisible=!0}catch(e){console.error("No se ha podido eliminar el rack",this.rackId,e),this.errorAlertVisible=!0}},openUpdateDialog(e){this.objectDto={rack_type:e.rack_type,rack_name:e.rack_name},this.rackId=e._id,this.dialogUpdateVisible=!0},closeUpdateDialog(){this.clearInput(),this.dialogUpdateVisible=!1},async updateRack(){console.log("ERORRRRRRRRRR",this.objectDto);const e={rack_type:this.objectDto.rack_type,rack_name:this.objectDto.rack_name};console.log(e);try{const t=await U(this.rackId,e);this.dialogVisible=!1,this.getRack(),console.log("UPDATED",t),this.clearInput(),this.alertVisible=!0,this.dialogUpdateVisible=!1}catch(t){console.error("No se ha podido actualizar el rack",this.rackId,t),this.clearInput(),this.errorAlertVisible=!0}},clearInput(){this.objectDto={rack_id:null,rack_type:null,rack_name:null}}},mounted(){this.getRack()}}),N=f("h2",null,"Gestor Rack",-1),T={class:"pa-4 text-center"},$={class:"pa-4 text-center"};function z(e,t,B,G,M,q){const d=r("v-text-field"),n=r("v-col"),s=r("v-btn"),u=r("v-divider"),g=r("v-icon"),b=r("v-data-table"),c=r("v-card"),m=r("v-row"),p=r("v-spacer"),v=r("v-card-title"),k=r("v-card-text"),h=r("v-card-actions"),_=r("v-dialog"),V=r("v-alert");return E(),I(w,null,[N,a(m,{class:"month-table"},{default:l(()=>[a(n,{cols:"3"},{default:l(()=>[a(d,{modelValue:e.search,"onUpdate:modelValue":t[0]||(t[0]=o=>e.search=o),class:"mx-auto",density:"comfortable","menu-icon":"",placeholder:"Buscar Rack","prepend-inner-icon":"mdi-magnify",theme:"light",variant:"solo","auto-select-first":"","item-props":"",hint:"Escriba para buscar",rounded:""},null,8,["modelValue"])]),_:1}),a(n,{cols:"3"},{default:l(()=>[a(s,{variant:"tonal",color:"primary",onClick:e.downloadPdf},{default:l(()=>[i("Generar archivo .csv")]),_:1},8,["onClick"])]),_:1}),a(n,{cols:"6",class:"text-right"},{default:l(()=>[a(s,{variant:"tonal",color:"primary","prepend-icon":"mdi-folder-outline",onClick:e.openCreateDialog},{default:l(()=>[i("Agregar Rack")]),_:1},8,["onClick"])]),_:1}),a(n,{cols:"12",sm:"12"},{default:l(()=>[a(c,{variant:e.variant,class:"mx-auto"},{default:l(()=>[a(u),a(n,null,{default:l(()=>[a(b,{"items-per-page":e.itemsPerPage,"onUpdate:itemsPerPage":t[1]||(t[1]=o=>e.itemsPerPage=o),"items-per-page-options":e.rowsPerPageItems,headers:e.headers,items:e.rackArray,loading:e.loading,search:e.search},{"item.actions":l(({item:o})=>[a(s,{class:"ml-2",color:"primary",icon:"",size:"x-small",flat:"",onClick:R=>e.openUpdateDialog(o)},{default:l(()=>[a(g,null,{default:l(()=>[i("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),a(s,{class:"ml-2",color:"error",icon:"",size:"x-small",flat:"",onClick:R=>e.openDeleteDialog(o)},{default:l(()=>[a(g,null,{default:l(()=>[i("mdi-delete")]),_:1})]),_:2},1032,["onClick"])]),_:1},8,["items-per-page","items-per-page-options","headers","items","loading","search"])]),_:1})]),_:1},8,["variant"])]),_:1})]),_:1}),a(_,{modelValue:e.dialogVisible,"onUpdate:modelValue":t[2]||(t[2]=o=>e.dialogVisible=o),"max-width":"400"},{default:l(()=>[a(c,null,{default:l(()=>[a(p),a(v,{class:"text-h5"},{default:l(()=>[i("Confirmar Eliminación")]),_:1}),a(k,null,{default:l(()=>[i("¿Estás seguro de que deseas eliminar este rack?")]),_:1}),a(h,null,{default:l(()=>[a(p),a(s,{color:"error",text:"",onClick:e.closeDeleteDialog},{default:l(()=>[i("Cancelar")]),_:1},8,["onClick"]),a(s,{color:"primary",text:"",onClick:e.confirmDeleteRack},{default:l(()=>[i("Eliminar")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),f("div",T,[a(_,{modelValue:e.dialog,"onUpdate:modelValue":t[5]||(t[5]=o=>e.dialog=o),"max-width":"600"},{default:l(()=>[a(c,{"prepend-icon":"mdi-folder-outline",title:"Agregar Rack"},{default:l(()=>[a(k,null,{default:l(()=>[a(m,{dense:""},{default:l(()=>[a(n,{cols:"12",md:"4",sm:"6"},{default:l(()=>[a(d,{label:"Tipo Rack",required:"",modelValue:e.objectDto.rack_type,"onUpdate:modelValue":t[3]||(t[3]=o=>e.objectDto.rack_type=o)},null,8,["modelValue"])]),_:1}),a(n,{cols:"12",md:"4",sm:"6"},{default:l(()=>[a(d,{hint:"Rack",label:"Nombre Rack",modelValue:e.objectDto.rack_name,"onUpdate:modelValue":t[4]||(t[4]=o=>e.objectDto.rack_name=o)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(u),a(h,null,{default:l(()=>[a(p),a(s,{color:"error",text:"Cancelar",variant:"plain",onClick:e.closeCreateDialog},null,8,["onClick"]),a(s,{color:"primary",text:"Guardar rack",variant:"tonal",onClick:e.saveRack},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),f("div",$,[a(_,{modelValue:e.dialogUpdateVisible,"onUpdate:modelValue":t[8]||(t[8]=o=>e.dialogUpdateVisible=o),"max-width":"600"},{default:l(()=>[a(c,{"prepend-icon":"mdi-folder-outline",title:"Actualizar Rack"},{default:l(()=>[a(k,null,{default:l(()=>[a(m,{dense:""},{default:l(()=>[a(n,{cols:"12",md:"4",sm:"6"},{default:l(()=>[a(d,{label:"Tipo Rack",required:"",modelValue:e.objectDto.rack_type,"onUpdate:modelValue":t[6]||(t[6]=o=>e.objectDto.rack_type=o)},null,8,["modelValue"])]),_:1}),a(n,{cols:"12",md:"4",sm:"6"},{default:l(()=>[a(d,{hint:"Rack",label:"Nombre Rack",modelValue:e.objectDto.rack_name,"onUpdate:modelValue":t[7]||(t[7]=o=>e.objectDto.rack_name=o)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(u),a(h,null,{default:l(()=>[a(s,{color:"error",text:"",onClick:e.closeUpdateDialog},{default:l(()=>[i("Cancelar")]),_:1},8,["onClick"]),a(s,{color:"primary",text:"",onClick:e.updateRack},{default:l(()=>[i("Actualizar")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),a(V,{modelValue:e.errorAlertVisible,"onUpdate:modelValue":t[9]||(t[9]=o=>e.errorAlertVisible=o),dismissible:"",color:"red",border:"left",elevation:"2","colored-border":"",icon:"mdi-alert",timeout:"5000"},{default:l(()=>[i(" Oops! Ha ocurrido un problema. ")]),_:1},8,["modelValue"])],64)}const Q=j(P,[["render",z]]);export{Q as default};
