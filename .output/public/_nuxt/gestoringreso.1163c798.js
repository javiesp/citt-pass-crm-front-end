import{g as U,I as M}from"./IngresoSemanal.b12ce8ef.js";import{d as j,r as x,j as z,k as W,a as l,o as r,e as b,b as e,w as t,g as s,l as H,v as q,h as T,c as m,F as V,f as F,t as p}from"./entry.4c01c827.js";import"./userApi.248f1fe6.js";import"./axios.4d564c32.js";import"./projectApi.98219bc6.js";const G=s("div",{class:"d-sm-flex align-center"},[s("div",null,[s("h3",{class:"text-h5 title mb-1"},"Días más concurridos"),s("h5",{class:"text-subtitle-1"},"Análisis semanal")])],-1),J={class:"mt-5"},K=s("div",{class:"bg-primary pa-5"},[s("h2",{class:"text-h5 mb-1"},"Últimos ingresos"),s("h5",{class:"text-subtitle-1"},"Ingresos diarios")],-1),P={class:"pa-4"},Q={class:"d-flex align-center py-3"},X={class:"mx-3"},Y={class:"text-h6 mt-n1 mb-1"},Z={class:"text-muted"},$={class:"bg-primary pa-5"},ee=s("h2",{class:"text-h5 mb-1"},"Últimos ingresos",-1),te=s("h5",{class:"text-subtitle-1"},"Ingresos diarios",-1),se={class:"pa-4"},ae={class:"d-flex align-center py-3"},oe=s("div",{class:"mr-3"},null,-1),le={class:"mx-3"},ne={class:"text-h6 mt-n1 mb-1"},re={class:"text-muted"},ie={class:"truncate-text text-subtitle-2 textSecondary"},he=j({__name:"gestoringreso",setup(ce){x([]);const v=x([]),C=x(!1),f=x(!1),w={series:[{name:"Ingresos",data:[]}]};function O(){const o={Mon:0,Tue:0,Wed:0,Thu:0,Fri:0,Sat:0,Sun:0};return v.value.forEach(d=>{const _=new Date(d.entry_date).toLocaleDateString("en-US",{weekday:"short"});o[_]!==void 0&&(o[_]+=1)}),Object.values(o)}const B=async()=>{try{f.value=!0;const o=await U();v.value=o.data,w.series[0].data=O(),f.value=!1}catch(o){console.error(o)}};function I(o,d){const n=document.createElement("a");n.href=URL.createObjectURL(o),n.download=d+".tsv",document.body.appendChild(n),n.click(),document.body.removeChild(n)}function D(){const o=v.value;let d=`FECHA DE ENTRADA	NOMBRE DE USUARIO	MOTIVO	VECES ENTRADA
`;o.forEach(i=>{let u="",a="";i.entry_reason?[u,a]=i.entry_reason.split(":").map(g=>g.trim()):a="Sin motivo";let y=i.entry_date+"	"+u+"	"+a+"	"+i.times_entered+`
`;d+=y});var n=new Blob([d],{type:"text/tab-separated-values"});const _="ingresos_citt_"+Date.now();I(n,_)}const L=z(()=>({grid:{show:!0,borderColor:"transparent",padding:{left:0,right:0,bottom:0}},plotOptions:{bar:{horizontal:!1,columnWidth:"35%",borderRadius:4}},colors:["#1e88e5"],chart:{type:"bar",height:250,toolbar:{show:!1},foreColor:"#adb0bb"},dataLabels:{enabled:!1},xaxis:{categories:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],labels:{style:{cssClass:"grey--text lighten-2--text fill-color"}}},yaxis:{title:{text:"Número de ingresos"},labels:{style:{cssClass:"grey--text lighten-2--text fill-color"}}},tooltip:{theme:"dark"}}));W(()=>{setTimeout(()=>C.value=!0,10)}),B();function N(){}return(o,d)=>{const n=M,_=l("apexchart"),i=l("v-card-text"),u=l("VCard"),a=l("v-col"),y=l("v-btn"),g=l("v-spacer"),h=l("v-row"),S=l("v-progress-circular"),k=l("v-list-item-title"),E=l("v-list-item"),A=l("v-list");return r(),b("div",null,[e(n),e(h,null,{default:t(()=>[s("div",null,[e(h,null,{default:t(()=>[e(a,{cols:"8"},{default:t(()=>[e(u,{class:"pa-3",elevation:"10"},{default:t(()=>[e(i,null,{default:t(()=>[G,H(s("div",J,[e(_,{type:"bar",height:"320",options:L.value,series:w.series},null,8,["options","series"])],512),[[q,C.value]])]),_:1})]),_:1})]),_:1}),e(a,{cols:"4"},{default:t(()=>[e(h,{style:{"margin-bottom":"5px"}},{default:t(()=>[e(a,null,{default:t(()=>[e(y,{onClick:D,variant:"tonal",color:"primary"},{default:t(()=>[T("Descargar ingresos")]),_:1})]),_:1}),e(a,null,{default:t(()=>[e(g)]),_:1})]),_:1}),e(u,{elevation:"10",class:"overflow-hidden"},{default:t(()=>[e(i,{class:"pa-0"},{default:t(()=>[K,s("div",P,[f.value?(r(),m(a,{key:0,cols:"12",class:"text-center"},{default:t(()=>[e(S,{size:200,width:17,color:"primary",indeterminate:""})]),_:1})):(r(),m(a,{key:1},{default:t(()=>[e(A,null,{default:t(()=>[(r(!0),b(V,null,F(v.value.slice(0,8),(c,R)=>(r(),m(E,{key:c._id},{default:t(()=>[e(k,null,{default:t(()=>[s("div",Q,[s("div",X,[s("h4",Y,p(c.entry_reason),1),s("div",Z,"Fecha de entrada: "+p(new Date(c.entry_date).toLocaleDateString()),1)])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}))])]),_:1})]),_:1})]),_:1})]),_:1})]),e(a,{cols:"4"},{default:t(()=>[e(h,{style:{"margin-bottom":"5px"}},{default:t(()=>[e(a,null,{default:t(()=>[e(y,{onClick:D,variant:"tonal",color:"primary"},{default:t(()=>[T("Descargar ingresos")]),_:1})]),_:1}),e(a,null,{default:t(()=>[e(g)]),_:1})]),_:1}),e(u,{elevation:"10",class:"overflow-hidden"},{default:t(()=>[e(i,{class:"pa-0"},{default:t(()=>[s("div",$,[e(h,null,{default:t(()=>[e(a)]),_:1}),ee,te]),s("div",se,[f.value?(r(),m(a,{key:0,cols:"12",class:"text-center"},{default:t(()=>[e(S,{size:200,width:17,color:"primary",indeterminate:""})]),_:1})):(r(),m(a,{key:1},{default:t(()=>[e(A,null,{default:t(()=>[(r(!0),b(V,null,F(v.value.slice(0,8),(c,R)=>(r(),m(E,{key:c._id,onClick:N},{default:t(()=>[e(k,null,{default:t(()=>[s("div",ae,[oe,s("div",le,[s("h4",ne,p(c.entry_reason),1),s("div",re,"Fecha de entrada: "+p(new Date(c.entry_date).toLocaleDateString()),1),s("div",ie," id: "+p(c.uid_user),1)])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}))])]),_:1})]),_:1})]),_:1})]),_:1})])}}});export{he as default};
