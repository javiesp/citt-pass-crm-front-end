import{g as F,I as N}from"./IngresoSemanal.1bb5f0ae.js";import{d as R,r as p,j as L,k as U,a as n,o as _,e as w,b as t,w as e,g as s,l as M,v as j,h as W,c as g,F as z,f as H,t as b}from"./entry.1c4aff53.js";import"./userApi.248f1fe6.js";import"./axios.4d564c32.js";import"./projectApi.98219bc6.js";const q=s("div",{class:"d-sm-flex align-center"},[s("div",null,[s("h3",{class:"text-h5 title mb-1"},"Días más concurridos"),s("h5",{class:"text-subtitle-1"},"Análisis semanal")])],-1),G={class:"mt-5"},J={class:"bg-primary pa-5"},K=s("h2",{class:"text-h5 mb-1"},"Últimos ingresos",-1),P=s("h5",{class:"text-subtitle-1"},"Ingresos diarios",-1),Q={class:"pa-4"},X={class:"d-flex align-center py-3"},Y=s("div",{class:"mr-3"},null,-1),Z={class:"mx-3"},$={class:"text-h6 mt-n1 mb-1"},tt={class:"text-muted"},et={class:"truncate-text text-subtitle-2 textSecondary"},ct=R({__name:"gestoringreso",setup(st){p([]);const u=p([]),x=p(!1),h=p(!1),C={series:[{name:"Ingresos",data:[]}]};function D(){const o={Mon:0,Tue:0,Wed:0,Thu:0,Fri:0,Sat:0,Sun:0};return u.value.forEach(r=>{const c=new Date(r.entry_date).toLocaleDateString("en-US",{weekday:"short"});o[c]!==void 0&&(o[c]+=1)}),Object.values(o)}const S=async()=>{try{h.value=!0;const o=await F();u.value=o.data,C.series[0].data=D(),h.value=!1}catch(o){console.error(o)}};function E(o,r){const l=document.createElement("a");l.href=URL.createObjectURL(o),l.download=r+".tsv",document.body.appendChild(l),l.click(),document.body.removeChild(l)}function k(){const o=u.value;let r=`FECHA DE ENTRADA	NOMBRE DE USUARIO	MOTIVO	VECES ENTRADA
`;o.forEach(i=>{let d="",a="";i.entry_reason?[d,a]=i.entry_reason.split(":").map(y=>y.trim()):a="Sin motivo";let f=i.entry_date+"	"+d+"	"+a+"	"+i.times_entered+`
`;r+=f});var l=new Blob([r],{type:"text/tab-separated-values"});const c="ingresos_citt_"+Date.now();E(l,c)}const A=L(()=>({grid:{show:!0,borderColor:"transparent",padding:{left:0,right:0,bottom:0}},plotOptions:{bar:{horizontal:!1,columnWidth:"35%",borderRadius:4}},colors:["#1e88e5"],chart:{type:"bar",height:250,toolbar:{show:!1},foreColor:"#adb0bb"},dataLabels:{enabled:!1},xaxis:{categories:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],labels:{style:{cssClass:"grey--text lighten-2--text fill-color"}}},yaxis:{title:{text:"Número de ingresos"},labels:{style:{cssClass:"grey--text lighten-2--text fill-color"}}},tooltip:{theme:"dark"}}));U(()=>{setTimeout(()=>x.value=!0,10)}),S();function T(){}return(o,r)=>{const l=N,c=n("apexchart"),i=n("v-card-text"),d=n("VCard"),a=n("v-col"),f=n("v-btn"),y=n("v-spacer"),m=n("v-row"),V=n("v-progress-circular"),I=n("v-list-item-title"),O=n("v-list-item"),B=n("v-list");return _(),w("div",null,[t(l),t(m,null,{default:e(()=>[s("div",null,[t(m,null,{default:e(()=>[t(a,{cols:"8"},{default:e(()=>[t(d,{class:"pa-3",elevation:"10"},{default:e(()=>[t(i,null,{default:e(()=>[q,M(s("div",G,[t(c,{type:"bar",height:"320",options:A.value,series:C.series},null,8,["options","series"])],512),[[j,x.value]])]),_:1})]),_:1})]),_:1}),t(a,{cols:"4"},{default:e(()=>[t(m,{style:{"margin-bottom":"5px"}},{default:e(()=>[t(a,null,{default:e(()=>[t(f,{onClick:k,variant:"tonal",color:"primary"},{default:e(()=>[W("Descargar ingresos")]),_:1})]),_:1}),t(a,null,{default:e(()=>[t(y)]),_:1})]),_:1}),t(d,{elevation:"10",class:"overflow-hidden",style:{width:"500px"}},{default:e(()=>[t(i,{class:"pa-0"},{default:e(()=>[s("div",J,[t(m,null,{default:e(()=>[t(a)]),_:1}),K,P]),s("div",Q,[h.value?(_(),g(a,{key:0,cols:"12",class:"text-center"},{default:e(()=>[t(V,{size:200,width:17,color:"primary",indeterminate:""})]),_:1})):(_(),g(a,{key:1},{default:e(()=>[t(B,null,{default:e(()=>[(_(!0),w(z,null,H(u.value.slice(0,8),(v,ot)=>(_(),g(O,{key:v._id,onClick:T},{default:e(()=>[t(I,null,{default:e(()=>[s("div",X,[Y,s("div",Z,[s("h4",$,b(v.entry_reason),1),s("div",tt,"Fecha de entrada: "+b(new Date(v.entry_date).toLocaleDateString()),1),s("div",et," id: "+b(v.uid_user),1)])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}))])]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})])}}});export{ct as default};
