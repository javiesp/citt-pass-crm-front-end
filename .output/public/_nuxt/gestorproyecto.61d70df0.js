import"./userApi.9f2b6974.js";import{g as P,s as C,u as A,d as w,c as U}from"./projectApi.aebb07c9.js";import{_ as k,d as I,a as i,e as E,b as t,w as o,g as _,F as N,r as T,o as R,h as s}from"./entry.8a599742.js";import"./axios.4d564c32.js";const B=I({name:"projectItem",data(){return{loading:!1,search:"",itemsPerPage:5,rowsPerPageItems:[{title:"5",value:5},{title:"10",value:10},{title:"25",value:25},{title:"50",value:50}],headers:[{title:"ID",value:"project_id"},{title:"Nombre",value:"project_name"},{title:"Descripción",value:"project_description"},{title:"Estatus proyecto",value:"project_status"},{title:"ID lista de deseo",value:"wishlist_id"},{title:"Acciones",value:"actions"}],dialogCreate:!1,usersArray:[],projectArray:[],projectsNamesArray:[],statusArray:["En proceso","En pausa","Completo","Sin iniciar","Descartado"],projectId:T(null),totalRows:0,searchQuery:"",selectedProyect:null,pdfUrl:"",pdfFileName:"",dialogVisible:!1,dialogUpdateVisible:!1,alertVisible:!1,errorAlertVisible:!1,objectDto:{project_id:null,project_name:"",project_description:"",project_status:"",wishlist_id:null,project_team_id:null}}},computed:{filteredRack(){return this.searchQuery?this.projectArray.filter(e=>e.project_name.toLowerCase().includes(this.searchQuery.toLowerCase())):this.projectArray}},methods:{async getProjects(){this.loading=!0;try{const e=await P();this.projectArray=e.data,this.projectsNamesArray=this.projectArray.map(l=>l.project_name)}catch(e){console.error("Error al obtener proyectos:",e),this.errorAlertVisible=!0}finally{this.loading=!1}},async searchItemByName(){if(console.log("id",this.projectId),this.projectId===null)this.getProjects();else try{const e=await C(this.projectId);this.projectArray=e.data,this.alertVisible=!0}catch(e){console.error("Error al obtener proyectos:",e),this.errorAlertVisible=!0}},downloadPdf(){const e=document.createElement("a");e.href=this.pdfUrl,e.target="_blank",e.download=this.pdfFileName,document.body.appendChild(e),e.click(),document.body.removeChild(e)},openUpdateDialog(e){this.projectId=e._id,this.dialogUpdateVisible=!0},closeUpdateDialog(){this.dialogUpdateVisible=!1},async updateProject(){console.log(this.objectDto);const e={project_name:this.objectDto.project_name,project_description:this.objectDto.project_description,project_status:this.objectDto.project_status,wishlist_id:this.objectDto.wishlist_id,project_team_id:this.objectDto.project_team_id};try{const l=await A(this.projectId,e);this.dialogVisible=!1,this.getProjects(),console.log("UPDATED",l),this.alertVisible=!0,this.dialogUpdateVisible=!1}catch(l){console.error("No se ha podido actualizar el proyecto",this.projectId,l),this.errorAlertVisible=!0}},openDeleteDialog(e){this.projectId=e._id,this.dialogVisible=!0,console.log("MIRA ACA"),console.log(this.projectId)},closeDeleteDialog(){this.dialogVisible=!1},async deleteProject(){console.log("aaaaaaaaaaaaaaaaa",this.projectId);try{const e=await w(this.projectId);this.dialogVisible=!1,this.getProjects(),console.log("DELETED",e),this.alertVisible=!0}catch(e){console.error("No se ha podido eliminar el proyecto",this.projectId,e),this.errorAlertVisible=!0}},openCreateDialog(){this.dialogCreate=!0},async createProject(){const e={project_id:this.objectDto.project_id,project_name:this.objectDto.project_name,project_description:this.objectDto.project_description,project_status:this.objectDto.project_status,wishlist_id:this.objectDto.wishlist_id,project_team_id:this.objectDto.project_team_id};console.log("asd",this.objectDto);try{console.log("llego hasta este punto bien");const l=await U(e);this.dialogCreate=!1,this.getProjects(),console.log("CREATED",l),this.alertVisible=!0,this.objectDto={project_id:null,project_name:"",project_description:"",project_status:"",wishlist_id:null,project_team_id:null}}catch(l){console.error("No se ha podido eliminar el proyecto",this.objectDto.project_id,l),this.errorAlertVisible=!0}}},watch:{},async created(){await this.getProjects(),console.log(this.projectArray),console.log("sel",this.projectId)}}),$=_("h2",null,"Proyectos Citt",-1),z={class:"pa-4 text-center"};function S(e,l,q,F,L,Q){const n=i("v-text-field"),r=i("v-col"),d=i("v-btn"),h=i("v-divider"),f=i("v-icon"),V=i("v-data-table"),p=i("v-card"),m=i("v-row"),g=i("v-card-title"),c=i("v-combobox"),u=i("v-card-text"),j=i("v-card-actions"),b=i("v-dialog"),D=i("v-spacer"),y=i("v-alert");return R(),E(N,null,[$,t(m,{class:"month-table"},{default:o(()=>[t(r,{cols:"3"},{default:o(()=>[t(n,{modelValue:e.search,"onUpdate:modelValue":l[0]||(l[0]=a=>e.search=a),class:"mx-auto",density:"comfortable","menu-icon":"",placeholder:"Buscar proyecto","prepend-inner-icon":"mdi-magnify",theme:"light",variant:"solo","auto-select-first":"","item-props":"",hint:"Escriba para buscar",rounded:""},null,8,["modelValue"])]),_:1}),t(r,{cols:"3"},{default:o(()=>[t(d,{variant:"tonal",color:"primary","prepend-icon":"mdi-folder-outline",onClick:e.openCreateDialog},{default:o(()=>[s("Agregar Proyecto")]),_:1},8,["onClick"])]),_:1}),t(r,{cols:"12",sm:"12"},{default:o(()=>[t(p,{variant:e.variant,class:"mx-auto"},{default:o(()=>[t(h),t(r,null,{default:o(()=>[t(V,{"items-per-page":e.itemsPerPage,"onUpdate:itemsPerPage":l[1]||(l[1]=a=>e.itemsPerPage=a),"items-per-page-options":e.rowsPerPageItems,headers:e.headers,items:e.projectArray,loading:e.loading,search:e.search},{"item.actions":o(({item:a})=>[t(d,{class:"ml-2",color:"primary",icon:"",size:"x-small",flat:"",onClick:v=>e.openUpdateDialog(a)},{default:o(()=>[t(f,null,{default:o(()=>[s("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),t(d,{class:"ml-2",color:"error",icon:"",size:"x-small",flat:"",onClick:v=>e.openDeleteDialog(a)},{default:o(()=>[t(f,null,{default:o(()=>[s("mdi-delete")]),_:1})]),_:2},1032,["onClick"])]),_:1},8,["items-per-page","items-per-page-options","headers","items","loading","search"])]),_:1})]),_:1},8,["variant"])]),_:1})]),_:1}),t(b,{modelValue:e.dialogUpdateVisible,"onUpdate:modelValue":l[7]||(l[7]=a=>e.dialogUpdateVisible=a),"max-width":"500px"},{default:o(()=>[t(p,null,{default:o(()=>[t(g,null,{default:o(()=>[s(" Actualizar proyecto ")]),_:1}),t(u,null,{default:o(()=>[t(u,null,{default:o(()=>[t(m,null,{default:o(()=>[t(r,{cols:"12",md:"6"},{default:o(()=>[t(n,{label:"Nombre Proyecto",modelValue:e.objectDto.project_name,"onUpdate:modelValue":l[2]||(l[2]=a=>e.objectDto.project_name=a)},null,8,["modelValue"])]),_:1}),t(r,{cols:"12",md:"6"},{default:o(()=>[t(n,{label:"Descripcion",modelValue:e.objectDto.project_description,"onUpdate:modelValue":l[3]||(l[3]=a=>e.objectDto.project_description=a)},null,8,["modelValue"])]),_:1}),t(r,{cols:"12",md:"4"},{default:o(()=>[t(c,{hint:"Status",label:"Status",modelValue:e.objectDto.project_status,"onUpdate:modelValue":l[4]||(l[4]=a=>e.objectDto.project_status=a),items:e.statusArray},null,8,["modelValue","items"])]),_:1}),t(r,{cols:"12",md:"4"},{default:o(()=>[t(c,{hint:"Proyect Team",label:"Wishlist",modelValue:e.objectDto.wishlist_id,"onUpdate:modelValue":l[5]||(l[5]=a=>e.objectDto.wishlist_id=a)},null,8,["modelValue"])]),_:1}),t(r,{cols:"12",md:"4"},{default:o(()=>[t(c,{hint:"Proyect Team",label:"Proyect Team",modelValue:e.objectDto.project_team_id,"onUpdate:modelValue":l[6]||(l[6]=a=>e.objectDto.project_team_id=a)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(j,null,{default:o(()=>[t(d,{color:"error",text:"",onClick:e.closeUpdateDialog},{default:o(()=>[s("Cancelar")]),_:1},8,["onClick"]),t(d,{color:"primary",text:"",onClick:e.updateProject},{default:o(()=>[s("Actualizar")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(b,{modelValue:e.dialogVisible,"onUpdate:modelValue":l[8]||(l[8]=a=>e.dialogVisible=a),"max-width":"500px"},{default:o(()=>[t(p,null,{default:o(()=>[t(g,null,{default:o(()=>[s(" Eliminar proyecto ")]),_:1}),t(u,null,{default:o(()=>[s(" ¿Está seguro de eliminar este proyecto? ")]),_:1}),t(j,null,{default:o(()=>[t(d,{color:"error",text:"",onClick:e.closeDeleteDialog},{default:o(()=>[s("Cancelar")]),_:1},8,["onClick"]),t(d,{color:"primary",text:"",onClick:e.deleteProject},{default:o(()=>[s("Eliminar")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),_("div",z,[t(b,{modelValue:e.dialogCreate,"onUpdate:modelValue":l[15]||(l[15]=a=>e.dialogCreate=a),"max-width":"600"},{default:o(()=>[t(p,{"prepend-icon":"mdi-folder-outline",title:"Agregar Proyecto"},{default:o(()=>[t(u,null,{default:o(()=>[t(m,null,{default:o(()=>[t(r,{cols:"12",md:"4"},{default:o(()=>[t(n,{label:"ID del Proyecto",modelValue:e.objectDto.project_id,"onUpdate:modelValue":l[9]||(l[9]=a=>e.objectDto.project_id=a),required:""},null,8,["modelValue"])]),_:1}),t(r,{cols:"12",md:"4"},{default:o(()=>[t(n,{label:"Nombre Proyecto",modelValue:e.objectDto.project_name,"onUpdate:modelValue":l[10]||(l[10]=a=>e.objectDto.project_name=a),required:""},null,8,["modelValue"])]),_:1}),t(r,{cols:"12",md:"4"},{default:o(()=>[t(n,{label:"Descripcion",modelValue:e.objectDto.project_description,"onUpdate:modelValue":l[11]||(l[11]=a=>e.objectDto.project_description=a),required:""},null,8,["modelValue"])]),_:1}),t(r,{cols:"12",md:"4"},{default:o(()=>[t(c,{hint:"Status",label:"Status",modelValue:e.objectDto.project_status,"onUpdate:modelValue":l[12]||(l[12]=a=>e.objectDto.project_status=a),items:e.statusArray,required:""},null,8,["modelValue","items"])]),_:1}),t(r,{cols:"12",md:"4"},{default:o(()=>[t(c,{hint:"Proyect Team",label:"Wishlist",modelValue:e.objectDto.wishlist_id,"onUpdate:modelValue":l[13]||(l[13]=a=>e.objectDto.wishlist_id=a)},null,8,["modelValue"])]),_:1}),t(r,{cols:"12",md:"4"},{default:o(()=>[t(c,{hint:"Proyect Team",label:"Proyect Team",modelValue:e.objectDto.project_team_id,"onUpdate:modelValue":l[14]||(l[14]=a=>e.objectDto.project_team_id=a)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(h),t(j,null,{default:o(()=>[t(D),t(d,{color:"error",text:"Cancelar",variant:"plain",onClick:e.closeDeleteDialog},null,8,["onClick"]),t(d,{color:"primary",text:"Crear proyecto",variant:"tonal",onClick:e.createProject},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_("div",null,[t(y,{modelValue:e.errorAlertVisible,"onUpdate:modelValue":l[16]||(l[16]=a=>e.errorAlertVisible=a),dismissible:"",color:"red",border:"left",elevation:"2","colored-border":"",icon:"mdi-alert",timeout:"5000"},{default:o(()=>[s(" Oops! Ha ocurrido un problema. ")]),_:1},8,["modelValue"])])],64)}const G=k(B,[["render",S]]);export{G as default};
