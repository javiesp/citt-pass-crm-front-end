import{a as P}from"./axios.4d564c32.js";import{_ as O,a as i,c as h,w as s,o as c,b as e,h as m,t as j,g as I,q as z,e as N,f as L,F as M,p as q,i as F}from"./entry.b5b73911.js";P.defaults.validateStatus=function(t){return t>=200&&t<300};const d=P.create({baseURL:"https://citt-pass-api-gateaway-backend-production.up.railway.app",timeout:1e5}),A=localStorage.getItem("accessToken");d.interceptors.request.use(t=>(A&&(t.headers.Authorization=`Bearer ${A}`),t),t=>Promise.reject(t));d.interceptors.response.use(t=>t,t=>Promise.reject(t));const G=t=>d.get("/users/find-one-user-by-mail",{params:{email:t}}),H=(t,o)=>(console.log(o),d.put(`/users/update-user-password/${t}`,o)),J=t=>d.get("/user-role/find-one-user-role-uid",{params:{uid_user:t}}),K=(t,o)=>d.put("/user-role/update-user-role/"+t,o);const Q={data(){return{loading:!1,loading2:!1,settingDialog:!1,loginDto:{email:null,hashed_password:null},showPassword:!1,open:["Users"],admins:[["Management","mdi-account-multiple-outline"],["Settings","mdi-cog-outline"]],cruds:[["Create","mdi-plus-outline"],["Read","mdi-file-outline"],["Update","mdi-update"],["Delete","mdi-delete"]],majors:[{title:"Informática Biomédica",value:"Informática Biomédica"},{title:"Ingeniería en Conectividad y Redes",value:"Ingeniería en Conectividad y Redes"},{title:"Ingeniería en Informática",value:"Ingeniería en Informática"},{title:"Analista Programador",value:"Analista Programador"},{title:"Analista Programador Computacional",value:"Analista Programador Computacional"},{title:"Administración de Redes y Telecomunicaciones",value:"Administración de Redes y Telecomunicaciones"},{title:"Técnico en Electricidad y Autom. Industrial",value:"Técnico en Electricidad y Autom. Industrial"},{title:"Ingeniería en Electricidad y Autom. Industrial",value:"Ingeniería en Electricidad y Autom. Industrial"}],emailUser:"",user_major:"",user_permissions:[],major_school:"",current_semester:null,items:[],post:{},passwordDTO:{id:"",hashed_password:""}}},created(){this.getUserData(),console.log("LOG",this.user_major),this.items=[{text:this.emailUser,icon:"mdi-account"},{text:this.user_major,icon:"mdi-school"},{text:this.major_school,icon:"mdi-office-building"},{text:this.current_semester+" semestre",icon:"mdi-calendar"}]},methods:{toggleShowPassword(){this.showPassword=!this.showPassword},async getUserData(){this.loading=!0,this.emailUser=localStorage.getItem("email");try{const t=await G(this.emailUser);this.passwordDTO._id=t.data._id,this.passwordDTO.hashed_password=t.data.hashed_password;const o=t.data.uid_user,n=await J(o);this.post=n.data,this.user_major=n.data.user_major,this.user_permissions=n.data.user_permissions,this.major_school=n.data.major_school,this.current_semester=n.data.current_semester,this.items=[{text:this.emailUser,icon:"mdi-account"},{text:this.user_major,icon:"mdi-school"},{text:this.major_school,icon:"mdi-office-building"},{text:this.current_semester+" semestre",icon:"mdi-calendar"}],this.loading=!1}catch(t){console.log(t),this.loding=!1}},sortSchool(t){let o="";return this.user_major==="Informática Biomédica"&&(o="Escuela de Salud"),(this.user_major==="Ingeniería en Conectividad y Redes"||this.user_major==="Ingeniería en Informática"||this.user_major==="Analista Programador"||this.user_major==="Analista Programador Computacional"||this.user_major==="Administración de Redes y Telecomunicaciones")&&(o="Escuela de Informática y Telecomunicaciones"),(this.user_major==="Técnico en Electricidad y Autom. Industrial"||this.user_major==="Ingeniería en Electricidad y Autom. Industrial")&&(o="Escuela de Ingeniería y Recursos Naturales"),o},async updateUserRole(){this.loading=!0,console.log(this.post);let t=this.sortSchool(this.user_major);console.log(this.user_major),console.log(t);const o={user_role_id:this.post.user_role_id,role_id:this.post.role_id,uid_user:this.post.uid_user,user_role:this.post.user_role,user_major:this.user_major,user_permissions:this.post.user_permissions,major_school:t,current_semester:this.current_semester};try{await K(this.post._id,o)&&(this.getUserData(),this.settingDialog=!1,this.loading=!1)}catch(n){console.log(n),this.settingDialog=!1,this.loading=!1}},async updatePassword(){this.loading2=!0;const t={hashed_password:this.passwordDTO.hashed_password};try{const o=await H(this.passwordDTO._id,t);this.loading2=!1}catch{this.loading2=!1}}}},D=t=>(q("data-v-24db6a3f"),t=t(),F(),t),W=D(()=>I("h2",null,"Perfil Usuario",-1)),X=D(()=>I("p",null,"Modifica tu perfil",-1));function Y(t,o,n,Z,a,g){const _=i("v-col"),l=i("v-skeleton-loader"),u=i("v-card"),b=i("v-list-title"),p=i("v-list-item"),k=i("v-card-title"),C=i("v-icon"),T=i("v-list-item-title"),U=i("v-list"),f=i("v-card-text"),v=i("v-btn"),w=i("v-card-actions"),V=i("v-autocomplete"),x=i("v-text-field"),y=i("v-row"),R=i("v-dialog"),S=i("v-list-group"),B=i("v-container");return c(),h(B,null,{default:s(()=>[e(y,null,{default:s(()=>[e(_,{cols:"12"},{default:s(()=>[W,X]),_:1}),e(y,{class:"row-container mb-6","no-gutters":""},{default:s(()=>[a.loading?(c(),h(_,{key:0,class:"loading-container",md:"12",sm:"5"},{default:s(()=>[e(u,null,{default:s(()=>[e(l,{type:"list-item-avatar"}),e(l,{type:"list-item-avatar"}),e(l,{type:"list-item-avatar"}),e(l,{type:"list-item-avatar"}),e(l,{type:"list-item-avatar"}),e(l,{type:"list-item-avatar"}),e(l,{type:"article"}),e(l,{type:"list-item"})]),_:1})]),_:1})):(c(),h(_,{key:1,md:"12",sm:"5"},{default:s(()=>[e(u,{title:"Información de perfil"},{default:s(()=>[e(f,null,{default:s(()=>[e(p,{"prepend-avatar":"/images/profile/user2.jpg"},{default:s(()=>[e(b,null,{default:s(()=>[m(j(a.emailUser),1)]),_:1}),I("h3",null,j(a.user_major),1)]),_:1},8,["prepend-avatar"]),e(U,{opened:a.open,"onUpdate:opened":o[5]||(o[5]=r=>a.open=r)},{default:s(()=>[e(p,{"prepend-icon":"mdi-cog",title:"Ajustes de perfil"}),e(S,{value:"Users"},{activator:s(({props:r})=>[e(p,z(r,{"prepend-icon":"mdi-account-circle",title:"Users"}),null,16)]),default:s(()=>[e(u,null,{default:s(()=>[e(k,null,{default:s(()=>[m("Datos del usuario")]),_:1}),e(f,null,{default:s(()=>[e(U,null,{default:s(()=>[(c(!0),N(M,null,L(a.items,(r,E)=>(c(),h(p,{key:E},{prepend:s(()=>[e(C,{icon:r.icon},null,8,["icon"])]),default:s(()=>[e(T,{textContent:j(r.text)},null,8,["textContent"])]),_:2},1024))),128))]),_:1})]),_:1}),e(w,null,{default:s(()=>[e(v,{onClick:o[0]||(o[0]=r=>a.settingDialog=!0),"prepend-icon":"mdi-account-edit"},{default:s(()=>[m(" Actualizar configuración de perfil ")]),_:1})]),_:1})]),_:1}),e(R,{modelValue:a.settingDialog,"onUpdate:modelValue":o[4]||(o[4]=r=>a.settingDialog=r),width:"600px"},{default:s(()=>[e(u,{title:"Actualizar"},{default:s(()=>[e(f,null,{default:s(()=>[e(y,null,{default:s(()=>[e(_,null,{default:s(()=>[e(V,{label:"Carreras",modelValue:a.user_major,"onUpdate:modelValue":o[1]||(o[1]=r=>a.user_major=r),items:a.majors,variant:"underlined"},null,8,["modelValue","items"]),e(x,{label:"Semestre",modelValue:a.current_semester,"onUpdate:modelValue":o[2]||(o[2]=r=>a.current_semester=r),type:"number",min:"1",max:"12",step:"1"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(w,null,{default:s(()=>[e(v,{onClick:o[3]||(o[3]=r=>g.updateUserRole()),"prepend-icon":"mdi-account-edit"},{default:s(()=>[m(" Actualizar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["opened"])]),_:1}),e(u,{title:"Actualizar contraseña",loading:a.loading2},{default:s(()=>[e(f,null,{default:s(()=>[e(x,{modelValue:a.passwordDTO.hashed_password,"onUpdate:modelValue":o[6]||(o[6]=r=>a.passwordDTO.hashed_password=r),label:"Password",outlined:"",dense:"",color:"blue",autocomplete:"off","append-icon":a.showPassword?"mdi-eye":"mdi-eye-off","onClick:append":g.toggleShowPassword,type:a.showPassword?"text":"password"},null,8,["modelValue","append-icon","onClick:append","type"])]),_:1}),e(w,null,{default:s(()=>[e(v,{onClick:o[7]||(o[7]=r=>g.updatePassword()),"prepend-icon":"mdi-lock-reset"},{default:s(()=>[m(" Actualizar contraseña ")]),_:1})]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))]),_:1})]),_:1})]),_:1})}const te=O(Q,[["render",Y],["__scopeId","data-v-24db6a3f"]]);export{te as default};
