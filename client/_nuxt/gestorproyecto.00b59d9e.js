import"./userApi.cc7d1a1a.js";import{g as k,s as E,u as I,d as N,c as T}from"./projectApi.0e4acb4b.js";import{_ as R,d as Q,a as s,e as h,f as t,w as o,h as r,F as g,r as S,b as V,k as d,i as B,t as p}from"./entry.bc374d72.js";import"./axios.4d564c32.js";const $=Q({data(){return{dialogCreate:!1,usersArray:[],projectArray:[],projectsNamesArray:[],statusArray:["En proceso","En pausa","Completo","Sin iniciar","Descartado"],projectId:S(null),totalRows:0,searchQuery:"",selectedProyect:null,pdfUrl:"",pdfFileName:"",dialogVisible:!1,dialogUpdateVisible:!1,alertVisible:!1,errorAlertVisible:!1,objectDto:{project_id:null,project_name:"",project_description:"",project_status:"",wishlist_id:null,project_team_id:null}}},computed:{filteredRack(){return this.searchQuery?this.projectArray.filter(e=>e.project_name.toLowerCase().includes(this.searchQuery.toLowerCase())):this.projectArray}},methods:{async getProjects(){this.loading=!0;try{const e=await k();this.projectArray=e.data,this.projectsNamesArray=this.projectArray.map(l=>l.project_name)}catch(e){console.error("Error al obtener proyectos:",e),this.errorAlertVisible=!0}finally{this.loading=!1}},async searchItemByName(){if(console.log("id",this.projectId),this.projectId===null)this.getProjects();else try{const e=await E(this.projectId);this.projectArray=e.data,this.alertVisible=!0}catch(e){console.error("Error al obtener proyectos:",e),this.errorAlertVisible=!0}},downloadPdf(){const e=document.createElement("a");e.href=this.pdfUrl,e.target="_blank",e.download=this.pdfFileName,document.body.appendChild(e),e.click(),document.body.removeChild(e)},openUpdateDialog(e){this.projectId=e,this.dialogUpdateVisible=!0},closeUpdateDialog(){this.dialogUpdateVisible=!1},async updateProject(){console.log(this.objectDto);const e={project_name:this.objectDto.project_name,project_description:this.objectDto.project_description,project_status:this.objectDto.project_status,wishlist_id:this.objectDto.wishlist_id,project_team_id:this.objectDto.project_team_id};try{const l=await I(this.projectId,e);this.dialogVisible=!1,this.getProjects(),console.log("UPDATED",l),this.alertVisible=!0,this.dialogUpdateVisible=!1}catch(l){console.error("No se ha podido actualizar el proyecto",this.projectId,l),this.errorAlertVisible=!0}},openDeleteDialog(e){this.projectId=e,this.dialogVisible=!0,console.log(this.projectId)},closeDeleteDialog(){this.dialogVisible=!1},async deleteProject(){console.log("aaaaaaaaaaaaaaaaa",this.projectId);try{const e=await N(this.projectId);this.dialogVisible=!1,this.getProjects(),console.log("DELETED",e),this.alertVisible=!0}catch(e){console.error("No se ha podido eliminar el proyecto",this.projectId,e),this.errorAlertVisible=!0}},openCreateDialog(){this.dialogCreate=!0},async createProject(){const e={project_id:this.objectDto.project_id,project_name:this.objectDto.project_name,project_description:this.objectDto.project_description,project_status:this.objectDto.project_status,wishlist_id:this.objectDto.wishlist_id,project_team_id:this.objectDto.project_team_id};console.log("asd",this.objectDto);try{console.log("llego hasta este punto bien");const l=await T(e);this.dialogCreate=!1,this.getProjects(),console.log("CREATED",l),this.alertVisible=!0,this.objectDto={project_id:null,project_name:"",project_description:"",project_status:"",wishlist_id:null,project_team_id:null}}catch(l){console.error("No se ha podido eliminar el proyecto",this.objectDto.project_id,l),this.errorAlertVisible=!0}}},watch:{},async created(){await this.getProjects(),console.log(this.projectArray),console.log("sel",this.projectId)}}),z=r("h2",null,"Proyectos Citt",-1),q=r("thead",null,[r("tr",null,[r("th",{class:"text-left"},"ID"),r("th",{class:"text-left"},"Proyecto"),r("th",{class:"text-left"},"Descripción"),r("th",{class:"text-left"},"Status"),r("th",{class:"text-left"},"Proyect team"),r("th",{class:"text-left"},"Acción")])],-1),F={class:"pa-4 text-center"};function L(e,l,W,G,H,O){const c=s("v-combobox"),i=s("v-col"),v=s("v-autocomplete"),n=s("v-btn"),y=s("v-icon"),C=s("v-table"),j=s("v-row"),D=s("v-card-title"),u=s("v-text-field"),m=s("v-card-text"),_=s("v-card-actions"),b=s("v-card"),f=s("v-dialog"),P=s("v-divider"),A=s("v-spacer"),w=s("v-alert");return V(),h(g,null,[z,t(j,{class:"month-table"},{default:o(()=>[t(i,{cols:"3"},{default:o(()=>[t(c,{modelValue:e.searchQuery,"onUpdate:modelValue":l[0]||(l[0]=a=>e.searchQuery=a),items:e.projectsNamesArray,label:"Proyecto",outlined:""},null,8,["modelValue","items"])]),_:1}),t(i,{cols:"3"},{default:o(()=>[t(v,{items:e.projectsNamesArray,"item-value":"projectArray.project_name",class:"mx-auto",density:"comfortable","menu-icon":"",placeholder:"Buscar Proyecto","prepend-inner-icon":"mdi-magnify",style:{"max-width":"350px"},theme:"light",variant:"solo","auto-select-first":"",modelValue:e.searchQuery,"onUpdate:modelValue":l[1]||(l[1]=a=>e.searchQuery=a),"item-props":"",hint:"Escriba para buscar",rounded:""},null,8,["items","modelValue"])]),_:1}),t(i,{cols:"3"},{default:o(()=>[t(n,{variant:"tonal",color:"primary",onClick:e.downloadPdf},{default:o(()=>[d("Generar archivo .csv")]),_:1},8,["onClick"])]),_:1}),t(i,{cols:"3",class:"text-right"},{default:o(()=>[t(n,{variant:"tonal",color:"primary","prepend-icon":"mdi-folder-outline",onClick:e.openCreateDialog},{default:o(()=>[d("Agregar Proyecto")]),_:1},8,["onClick"])]),_:1}),t(i,{cols:"12",sm:"12"},{default:o(()=>[t(C,null,{default:o(()=>[q,r("tbody",null,[(V(!0),h(g,null,B(e.filteredRack,a=>(V(),h("tr",{key:a.project_id},[r("td",null,p(a.project_id),1),r("td",null,p(a.project_name),1),r("td",null,p(a.project_description),1),r("td",null,p(a.project_status),1),r("td",null,p(a.project_id_team),1),r("td",null,[t(i,null,{default:o(()=>[t(n,{class:"ml-2",color:"primary",icon:"",size:"x-small",flat:"",onClick:U=>e.openUpdateDialog(a._id)},{default:o(()=>[t(y,null,{default:o(()=>[d("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),t(n,{class:"ml-2",color:"error",icon:"",size:"x-small",flat:"",onClick:U=>e.openDeleteDialog(a._id)},{default:o(()=>[t(y,null,{default:o(()=>[d("mdi-delete")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]))),128))])]),_:1})]),_:1})]),_:1}),t(f,{modelValue:e.dialogUpdateVisible,"onUpdate:modelValue":l[7]||(l[7]=a=>e.dialogUpdateVisible=a),"max-width":"500px"},{default:o(()=>[t(b,null,{default:o(()=>[t(D,null,{default:o(()=>[d(" Actualizar proyecto ")]),_:1}),t(m,null,{default:o(()=>[t(m,null,{default:o(()=>[t(j,null,{default:o(()=>[t(i,{cols:"12",md:"6"},{default:o(()=>[t(u,{label:"Nombre Proyecto",modelValue:e.objectDto.project_name,"onUpdate:modelValue":l[2]||(l[2]=a=>e.objectDto.project_name=a)},null,8,["modelValue"])]),_:1}),t(i,{cols:"12",md:"6"},{default:o(()=>[t(u,{label:"Descripcion",modelValue:e.objectDto.project_description,"onUpdate:modelValue":l[3]||(l[3]=a=>e.objectDto.project_description=a)},null,8,["modelValue"])]),_:1}),t(i,{cols:"12",md:"4"},{default:o(()=>[t(c,{hint:"Status",label:"Status",modelValue:e.objectDto.project_status,"onUpdate:modelValue":l[4]||(l[4]=a=>e.objectDto.project_status=a),items:e.statusArray},null,8,["modelValue","items"])]),_:1}),t(i,{cols:"12",md:"4"},{default:o(()=>[t(c,{hint:"Proyect Team",label:"Wishlist",modelValue:e.objectDto.wishlist_id,"onUpdate:modelValue":l[5]||(l[5]=a=>e.objectDto.wishlist_id=a)},null,8,["modelValue"])]),_:1}),t(i,{cols:"12",md:"4"},{default:o(()=>[t(c,{hint:"Proyect Team",label:"Proyect Team",modelValue:e.objectDto.project_team_id,"onUpdate:modelValue":l[6]||(l[6]=a=>e.objectDto.project_team_id=a)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(_,null,{default:o(()=>[t(n,{color:"error",text:"",onClick:e.closeUpdateDialog},{default:o(()=>[d("Cancelar")]),_:1},8,["onClick"]),t(n,{color:"primary",text:"",onClick:e.updateProject},{default:o(()=>[d("Actualizar")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(f,{modelValue:e.dialogVisible,"onUpdate:modelValue":l[8]||(l[8]=a=>e.dialogVisible=a),"max-width":"500px"},{default:o(()=>[t(b,null,{default:o(()=>[t(D,null,{default:o(()=>[d(" Eliminar proyecto ")]),_:1}),t(m,null,{default:o(()=>[d(" ¿Está seguro de eliminar este proyecto? ")]),_:1}),t(_,null,{default:o(()=>[t(n,{color:"error",text:"",onClick:e.closeDeleteDialog},{default:o(()=>[d("Cancelar")]),_:1},8,["onClick"]),t(n,{color:"primary",text:"",onClick:e.deleteProject},{default:o(()=>[d("Eliminar")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),r("div",F,[t(f,{modelValue:e.dialogCreate,"onUpdate:modelValue":l[15]||(l[15]=a=>e.dialogCreate=a),"max-width":"600"},{default:o(()=>[t(b,{"prepend-icon":"mdi-folder-outline",title:"Agregar Proyecto"},{default:o(()=>[t(m,null,{default:o(()=>[t(j,null,{default:o(()=>[t(i,{cols:"12",md:"4"},{default:o(()=>[t(u,{label:"ID del Proyecto",modelValue:e.objectDto.project_id,"onUpdate:modelValue":l[9]||(l[9]=a=>e.objectDto.project_id=a),required:""},null,8,["modelValue"])]),_:1}),t(i,{cols:"12",md:"4"},{default:o(()=>[t(u,{label:"Nombre Proyecto",modelValue:e.objectDto.project_name,"onUpdate:modelValue":l[10]||(l[10]=a=>e.objectDto.project_name=a),required:""},null,8,["modelValue"])]),_:1}),t(i,{cols:"12",md:"4"},{default:o(()=>[t(u,{label:"Descripcion",modelValue:e.objectDto.project_description,"onUpdate:modelValue":l[11]||(l[11]=a=>e.objectDto.project_description=a),required:""},null,8,["modelValue"])]),_:1}),t(i,{cols:"12",md:"4"},{default:o(()=>[t(c,{hint:"Status",label:"Status",modelValue:e.objectDto.project_status,"onUpdate:modelValue":l[12]||(l[12]=a=>e.objectDto.project_status=a),items:e.statusArray,required:""},null,8,["modelValue","items"])]),_:1}),t(i,{cols:"12",md:"4"},{default:o(()=>[t(c,{hint:"Proyect Team",label:"Wishlist",modelValue:e.objectDto.wishlist_id,"onUpdate:modelValue":l[13]||(l[13]=a=>e.objectDto.wishlist_id=a)},null,8,["modelValue"])]),_:1}),t(i,{cols:"12",md:"4"},{default:o(()=>[t(c,{hint:"Proyect Team",label:"Proyect Team",modelValue:e.objectDto.project_team_id,"onUpdate:modelValue":l[14]||(l[14]=a=>e.objectDto.project_team_id=a)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(P),t(_,null,{default:o(()=>[t(A),t(n,{color:"error",text:"Cancelar",variant:"plain",onClick:e.closeDeleteDialog},null,8,["onClick"]),t(n,{color:"primary",text:"Crear proyecto",variant:"tonal",onClick:e.createProject},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),r("div",null,[t(w,{modelValue:e.errorAlertVisible,"onUpdate:modelValue":l[16]||(l[16]=a=>e.errorAlertVisible=a),dismissible:"",color:"red",border:"left",elevation:"2","colored-border":"",icon:"mdi-alert",timeout:"5000"},{default:o(()=>[d(" Oops! Ha ocurrido un problema. ")]),_:1},8,["modelValue"])])],64)}const Y=R($,[["render",L]]);export{Y as default};
